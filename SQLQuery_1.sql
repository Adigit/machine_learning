SELECT * FROM sys.databases;

 ----------- SQL ASSIGNMENT 1 -----------

CREATE DATABASE DEMO; 

USE DEMO;

CREATE TABLE EMP(
    EID CHAR(10),
    NAME VARCHAR(30),
    ADDR VARCHAR(40),
    CITY VARCHAR(10),
    DOB DATE,
    PHONE VARCHAR(15),
    EMAIL VARCHAR(30)
);

SELECT * FROM INFORMATION_SCHEMA.TABLES;

----------- INSERTING 10 VALID RECORDS  -----------

INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0001', 'ADITYA', 'SECTOR 33', 'GURUGRAM', '12-04-1993', '8377836254', 'aditya@yahoo.com');

INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0002', 'ANKITA SRIVASTAV', 'SECTOR 34', 'GURUGRAM', '11-04-1995', '8377816254', 'ankita.srivastava@yahoo.com');

INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0003', 'AJAY PANDEY', 'ROHINI', 'DELHI', '11-23-1998', '9977836254', 'ajay.pandey@google.com');

INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0004', 'SARVESH KUMAR SHARMA', 'KIDWAI NAGAR', 'KANPUR', '01-19-1991', '8532836254', 'sarvesh.kumar.sharma@yahoo.com');

INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0005', 'ABHIROOP', 'SECTOR 11', 'GURUGRAM', '02-24-1995', '9977726254', 'abhiroop@hotmail.com');

INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0006', 'APOORV SRIVASTAVA', 'SECTOR 62', 'NOIDA', '07-11-1999', '8377123254', 'apoorvsrivastava123@gmail.com');

INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0007', 'ANURAG GAUR', 'LAXMI NAGAR', 'DELHI', '05-11-1993', '9145836254', 'anurag.gaur@yahoo.com');

INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0008', 'AADESH KUMAR SRIVASTAVA', 'SECTOR 48, SHONA ROAD', 'GURUGRAM', '03-02-1993', '8463836254', 'aadesh.srivastava@hotmail.com');

INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0009', 'YOGESH KUMAR VERMA', 'SECTOR 33', 'GURUGRAM', '09-11-1991', '881784538', 'yogesh@yahoo.com');

INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0010', 'GURDEEP SINGH', 'SECTOR 10', 'GURUGRAM', '11-06-1993', '8377836254', 'gurdeep.singh@gmail.com');

----------- SELECT ALL INSERTED DATA INTO EMP TABLE  -----------

SELECT * FROM EMP;

------------------------------------------------------------------

CREATE TABLE EMP_SAL(
       EID CHAR(10),
       DEPT VARCHAR(10),
       DESI VARCHAR(20), 
       DOJ DATE,
       SALARY INT
);

INSERT INTO EMP_SAL (EID, DEPT, DESI, DOJ, SALARY) VALUES ('E0001', 'HR', 'MANAGER', '05-10-2021', '100000');

INSERT INTO EMP_SAL (EID, DEPT, DESI, DOJ, SALARY) VALUES ('E0002', 'IT', 'ENGINEERING MANAGER', '10-11-2021', '2500000');

INSERT INTO EMP_SAL (EID, DEPT, DESI, DOJ, SALARY) VALUES ('E0003', 'ADMIN', 'MANAGER', '01-12-2022', '300000');

INSERT INTO EMP_SAL (EID, DEPT, DESI, DOJ, SALARY) VALUES ('E0004', 'ADMIN', 'SENIOR MANAGER', '06-15-2021', '400000');

INSERT INTO EMP_SAL (EID, DEPT, DESI, DOJ, SALARY) VALUES ('E0005', 'DEVOPS', 'MANAGER', '02-26-2023', '5500000');

INSERT INTO EMP_SAL (EID, DEPT, DESI, DOJ, SALARY) VALUES ('E0006', 'IT', 'DEVELOPER', '11-11-2020', '600000');

INSERT INTO EMP_SAL (EID, DEPT, DESI, DOJ, SALARY) VALUES ('E0007', 'HR', 'SENIOR MANAGER', '09-20-2021', '700000');


SELECT * FROM EMP_SAL;


SELECT * FROM EMP WHERE NAME LIKE '%SHARMA';

UPDATE EMP_SAL SET SALARY = (SALARY * 1.1) WHERE DESI = 'MANAGER';

SELECT * FROM EMP_SAL;


-----------------------------------------------------------------------------------
-------------------------------- Assignment 3 -------------------------------------


-- ADDING NOT NULL VALIDATION FOR EID ---
ALTER TABLE EMP
ALTER COLUMN EID CHAR(10) NOT NULL;


--- MAKING EID AS PRIMARY KEY -----
ALTER TABLE EMP 
ADD CONSTRAINT EMP_PK PRIMARY KEY(EID); 

-- ADDING NOT NULL VALIDATION FOR NAME --
ALTER TABLE EMP
ALTER COLUMN NAME VARCHAR(30) NOT NULL;

-- ADDING CHECK CONSTRAING THAT NO EMPLOYEE FROM UTTAM NAGAR --
ALTER TABLE EMP
ADD CONSTRAINT ADDR_UTTAM_NAGAR_NOT_ALLOWED CHECK( ADDR NOT LIKE '%UTTAM NAGAR%');

-- ALTER TABLE EMP
-- DROP CONSTRAINT ADDR_UTTAM_NAGAR_NOT_ALLOWED;

SELECT * FROM EMP;
INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0011', 'MAHENDRA SINGH', 'SECTOR 50, UTTAM NAGAR', 'DELHI', '11-06-1993', '8311836254', 'mahendra.singh@gmail.com');

-- UPDATE EMP 
-- SET CITY = 'GGN' WHERE CITY = 'GURUGRAM';

-- UPDATE EMP 
-- SET CITY = 'DEL' WHERE CITY = 'DELHI';

-- UPDATE EMP 
-- SET CITY = 'FBD' WHERE CITY = 'KANPUR';
 
-- ADDING CHECK CONSTRAINT FOR CITY ('GGN', 'DEL', 'FBD', 'NOIDA') --
ALTER TABLE EMP
ADD CONSTRAINT CITY_CHECK CHECK (CITY IN ('GGN', 'DEL', 'FBD', 'NOIDA'));

-- UPDATE EMP 
-- SET PHONE = '1177836254' WHERE EID = 'E0010';

-- ADDING UNIQUENESS CONSTRAINT ON PHONE --
ALTER TABLE EMP 
ADD CONSTRAINT EMP_PHONE_UNIQUE UNIQUE(PHONE);

-- UPDATE EMP 
-- SET EMAIL = 'ajay.pandey@gmail.com' WHERE EMAIL = 'ajay.pandey@google.com';

-- UPDATE EMP 
-- SET EMAIL = 'abhiroop@yahoo.com' WHERE EMAIL = 'abhiroop@hotmail.com';

-- UPDATE EMP 
-- SET EMAIL = 'aadesh.srivastava@gmail.com' WHERE EMAIL = 'aadesh.srivastava@hotmail.com';

-- ADDING CHECK CONSTRAING THAT NO EMPLOYEE FROM UTTAM NAGAR --
ALTER TABLE EMP
ADD CONSTRAINT EMP_EMAIL_VALIDATION CHECK( EMAIL LIKE '%GMAIL%' OR EMAIL LIKE '%YAHOO%');

-- INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0011', 'ANKIT SHARMA', 'SECTOR 18', 'GGN', '02-24-1995', '6532726254', 'abhiroop@hotmail.com');

ALTER TABLE EMP
ADD CONSTRAINT EMP_DOB_VALIDATION CHECK(DOB < '01-01-2000');

-- INSERT INTO EMP(EID, NAME, ADDR, CITY, DOB ,PHONE, EMAIL) VALUES('E0011', 'ANKIT SHARMA', 'SECTOR 18', 'GGN', '02-24-2002', '6532726254', 'abhiroop@gmail.com');

-- EXEC sp_rename 'dbo.EMP_SAL.EID', 'EMPID', 'COLUMN';

ALTER TABLE EMP_SAL
ADD CONSTRAINT EMP_SAL_FK_EID FOREIGN KEY(EMPID) REFERENCES EMP(EID);

-- UPDATE EMP_SAL 
-- SET DEPT = 'OPS' WHERE DEPT = 'DEVOPS';

ALTER TABLE EMP_SAL
ADD CONSTRAINT EMP_SAL_DEPT_VALIDATION CHECK(DEPT IN ('HR', 'MIS', 'OPS', 'IT', 'ADMIN', 'TEMP'));

-- UPDATE EMP_SAL 
-- SET DESI = 'MGR' WHERE DESI = 'MANAGER';

-- UPDATE EMP_SAL 
-- SET DESI = 'ASSO' WHERE DESI = 'SENIOR MANAGER';

-- UPDATE EMP_SAL 
-- SET DESI = 'VP' WHERE DESI = 'ENGINEERING MANAGER';

-- UPDATE EMP_SAL 
-- SET DESI = 'DIR' WHERE DESI = 'DEVELOPER';

-- SELECT * FROM EMP_SAL;

ALTER TABLE EMP_SAL
ADD CONSTRAINT EMP_SAL_DESI_VALIDATION CHECK(DESI IN ('ASSO', 'MGR', 'VP', 'DIR'));

-- EXEC sp_rename 'dbo.EMP_SAL.SALARY', 'BASIC', 'COLUMN';

-- ADDING CONSTRAINT VALIDATION : BASIC SALARY MUST BE GREATER THAN 20000 --
ALTER TABLE EMP_SAL
ADD CONSTRAINT EMP_SAL_BASIC_VALIDATION CHECK (BASIC > 20000);

-- ADDING DEFAULT VALUE FOR DEPT COLUMN --
ALTER TABLE EMP_SAL
ADD CONSTRAINT EMP_SAL_DEFAULT_DEPT DEFAULT 'TEMP' FOR DEPT;

------------------------------------------------------------------------------------------
----------------------------------- ASSIGNMENT 4 -----------------------------------------

SELECT * FROM EMP;

SELECT CITY, COUNT(EID) AS NO_OF_EMPLOYESS FROM EMP GROUP BY CITY ORDER BY NO_OF_EMPLOYESS DESC;

SELECT * FROM EMP WHERE EMAIL NOT LIKE '%YAHOO%';

SELECT * FROM EMP_SAL;

SELECT DESI, SUM(BASIC) AS BASIC_SALARY, COUNT(EMPID) AS NUMBER_OF_EMPLOYEES FROM EMP_SAL GROUP BY DESI ORDER BY BASIC_SALARY DESC;

------------------------------------------------------------------------------------------
----------------------------------- ASSIGNMENT 5 -----------------------------------------

SELECT * FROM EMP;

SELECT EID, NAME, CITY, DOJ, DEPT, DESI, BASIC AS SALARY
FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID = EMP_SAL.EMPID
WHERE CITY = 'DEL';

SELECT * FROM EMP 
WHERE EID NOT IN (
    SELECT EMPID FROM EMP_SAL
);

----------------------------------------- INVENTORY SYSTEM -----------------------------------------
----------------------------------------------------------------------------------------------------

CREATE TABLE SUPPLIER(
    SID CHAR(5) PRIMARY KEY,
    SNAME VARCHAR(20) NOT NULL,
    SADD VARCHAR(50) NOT NULL,
    SCITY VARCHAR(20) DEFAULT 'DELHI',
    SPHONE CHAR(15) UNIQUE,
    EMAIL VARCHAR(20)
);

CREATE TABLE PRODUCT(
    PID CHAR(5) PRIMARY KEY,
    PDESC VARCHAR(50) NOT NULL,
    PRICE DECIMAL CHECK (PRICE > 0),
    CATEGORY CHAR(2) CHECK (CATEGORY = 'IT' OR CATEGORY = 'HA' OR CATEGORY = 'HC'),
    SID CHAR(5) FOREIGN KEY REFERENCES SUPPLIER(SID)
);

CREATE TABLE STOCK(
    PID CHAR(5) FOREIGN KEY REFERENCES PRODUCT(PID),
    SQTY INT CHECK(SQTY >= 0),
    ROL INT CHECK(ROL > 0),
    MOQ INT CHECK(MOQ >= 5)
);

CREATE TABLE CUST(
    CID CHAR(5) PRIMARY KEY,
    CNAME VARCHAR(20) NOT NULL,
    ADDRESS VARCHAR(20) NOT NULL,
    CITY VARCHAR(20) NOT NULL,
    PHONE CHAR(15) NOT NULL,
    EMAIL VARCHAR(20) NOT NULL,
    DOB DATE CHECK(DOB < '01-01-2000')
);

-- ALTER TABLE CUST ALTER COLUMN EMAIL VARCHAR(40) NOT NULL;
-- ALTER TABLE CUST ALTER COLUMN CNAME VARCHAR(30) NOT NULL;
-- ALTER TABLE CUST ALTER COLUMN ADDRESS VARCHAR(40) NOT NULL;

CREATE TABLE ORDERS(
    OID CHAR(5) PRIMARY KEY,
    ODATE DATE,
    PID CHAR(5) FOREIGN KEY REFERENCES PRODUCT(PID),
    CID CHAR(5) FOREIGN KEY REFERENCES CUST(CID),
    OQTY INT CHECK(OQTY >= 1)
);

-- DESCRIBE TABLE IN SQL SERVER --
EXEC sp_help STOCK;

INSERT INTO SUPPLIER (SID, SNAME, SADD, SCITY, SPHONE, EMAIL) VALUES ('S0001', 'ADITYA', 'SECTOR 11', 'GURUGRAM', '8377836255', 'ADITYA.SRI@GMAIL.COM');
INSERT INTO SUPPLIER (SID, SNAME, SADD, SCITY, SPHONE, EMAIL) VALUES ('S0002', 'AJAY', 'SECTOR 20', 'NOIDA', '8377831234', 'AJAYPAN@GMAIL.COM');
INSERT INTO SUPPLIER (SID, SNAME, SADD, SPHONE, EMAIL) VALUES ('S0003', 'Ankita', 'DWARAKA', '9977836255', 'ANKITAJAIS@YAHOO.COM');
INSERT INTO SUPPLIER (SID, SNAME, SADD, SCITY, SPHONE, EMAIL) VALUES ('S0004', 'SARVESH SHARMA', 'SECTOR 76', 'NOIDA', '8376436255', 'SARVESHS@YAHOO.COM');
INSERT INTO SUPPLIER (SID, SNAME, SADD, SCITY, SPHONE, EMAIL) VALUES ('S0005', 'ANURAG GAUR', 'ROHINI', 'DELHI', '8154836255', 'ANURAGG@GMAIL.COM');
INSERT INTO SUPPLIER (SID, SNAME, SADD, SCITY, SPHONE, EMAIL) VALUES ('S0006', 'SUMIT DASH', 'SECTOR 07', 'NOIDA', '8311836255', 'SUMITD@GMAIL.COM');
INSERT INTO SUPPLIER (SID, SNAME, SADD, SCITY, SPHONE, EMAIL) VALUES ('S0007', 'GAGANDEEP SINGH', 'SECTOR 22', 'GURUGRAM', '8377654235', 'GAGAN@YAHOO.COM');
INSERT INTO SUPPLIER (SID, SNAME, SADD, SCITY, SPHONE, EMAIL) VALUES ('S0008', 'RAHUL', 'SECTOR 50', 'NOIDA', '4577876255', 'RAHULPAK@GMAIL.COM');
INSERT INTO SUPPLIER (SID, SNAME, SADD, SCITY, SPHONE, EMAIL) VALUES ('S0009', 'NANDITA YADAV', 'SECTOR 21', 'GURUGRAM', '8945836255', 'NANDITA@GMAIL.COM');
INSERT INTO SUPPLIER (SID, SNAME, SADD, SCITY, SPHONE, EMAIL) VALUES ('S0010', 'ISHITA', 'SECTOR 52', 'GURUGRAM', '876326255', 'ISITA@GMAIL.COM');

-- SELECT * FROM SUPPLIER;

INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0001', 'MONITOR', 20000, 'IT', 'S0003');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0002', 'TV', 50000, 'HA', 'S0002');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0003', 'WASHING MACHINE', 20000, 'HA', 'S0002');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0004', 'FRIDGE', 80000, 'HA', 'S0003');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0005', 'KEY BOARD', 15000, 'IT', 'S0004');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0006', 'MOUSE', 10000, 'IT', 'S0003');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0007', 'LAPTOP', 20000, 'IT', 'S0001');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0008', 'CPU', 20000, 'IT', 'S0003');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0009', 'AC', 20000, 'HA', 'S0008');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0010', 'SPLIT AC', 20000, 'HA', 'S0009');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0011', 'UPS', 20000, 'IT', 'S0003');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0012', 'SANETIZER', 20000, 'HC', 'S0010');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0013', 'MASK', 20000, 'HC', 'S0010');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0014', 'HAND WASH', 20000, 'HC', 'S0005');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0015', 'FACE WASH', 20000, 'HC', 'S0007');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0016', 'MEDICINE', 20000, 'HC', 'S0007');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0017', 'FAN', 20000, 'HA', 'S0006');
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID) VALUES ('P0018', 'DISH WASHER', 20000, 'HA', 'S0004');

-- SELECT * FROM PRODUCT;

INSERT INTO STOCK (PID, SQTY, ROL, MOQ) VALUES ('P0001', 2, 4, 10);
INSERT INTO STOCK (PID, SQTY, ROL, MOQ) VALUES ('P0002', 7, 2, 8);
INSERT INTO STOCK (PID, SQTY, ROL, MOQ) VALUES ('P0003', 4, 3, 12);
INSERT INTO STOCK (PID, SQTY, ROL, MOQ) VALUES ('P0004', 6, 5, 6);
INSERT INTO STOCK (PID, SQTY, ROL, MOQ) VALUES ('P0005', 3, 2, 5);
INSERT INTO STOCK (PID, SQTY, ROL, MOQ) VALUES ('P0006', 2, 3, 15);
INSERT INTO STOCK (PID, SQTY, ROL, MOQ) VALUES ('P0007', 7, 4, 6);
INSERT INTO STOCK (PID, SQTY, ROL, MOQ) VALUES ('P0008', 5, 6, 7);
INSERT INTO STOCK (PID, SQTY, ROL, MOQ) VALUES ('P0009', 6, 10, 9);
INSERT INTO STOCK (PID, SQTY, ROL, MOQ) VALUES ('P0010', 2, 8, 11);

-- SELECT * FROM STOCK;

INSERT INTO CUST(CID, CNAME, ADDRESS, CITY, DOB ,PHONE, EMAIL) VALUES('C0001', 'ADITYA', 'SECTOR 33', 'GURUGRAM', '12-04-1993', '8377836254', 'aditya@yahoo.com');
INSERT INTO CUST(CID, CNAME, ADDRESS, CITY, DOB ,PHONE, EMAIL) VALUES('C0002', 'ANKITA SRIVASTAV', 'SECTOR 34', 'GURUGRAM', '11-04-1995', '8377816254', 'ankita.srivastava@yahoo.com');
INSERT INTO CUST(CID, CNAME, ADDRESS, CITY, DOB ,PHONE, EMAIL) VALUES('C0003', 'AJAY PANDEY', 'ROHINI', 'DELHI', '11-23-1998', '9977836254', 'ajay.pandey@google.com');
INSERT INTO CUST(CID, CNAME, ADDRESS, CITY, DOB ,PHONE, EMAIL) VALUES('C0004', 'SARVESH KUMAR SHARMA', 'KIDWAI NAGAR', 'KANPUR', '01-19-1991', '8532836254', 'sarvesh.kumar.sharma@yahoo.com');
INSERT INTO CUST(CID, CNAME, ADDRESS, CITY, DOB ,PHONE, EMAIL) VALUES('C0005', 'ABHIROOP', 'SECTOR 11', 'GURUGRAM', '02-24-1995', '9977726254', 'abhiroop@hotmail.com');
INSERT INTO CUST(CID, CNAME, ADDRESS, CITY, DOB ,PHONE, EMAIL) VALUES('C0006', 'APOORV SRIVASTAVA', 'SECTOR 62', 'NOIDA', '07-11-1999', '8377123254', 'apoorvsrivastava123@gmail.com');
INSERT INTO CUST(CID, CNAME, ADDRESS, CITY, DOB ,PHONE, EMAIL) VALUES('C0007', 'ANURAG GAUR', 'LAXMI NAGAR', 'DELHI', '05-11-1993', '9145836254', 'anurag.gaur@yahoo.com');
INSERT INTO CUST(CID, CNAME, ADDRESS, CITY, DOB ,PHONE, EMAIL) VALUES('C0008', 'AADESH KUMAR SRIVASTAVA', 'SECTOR 48, SHONA ROAD', 'GURUGRAM', '03-02-1993', '8463836254', 'aadesh.srivastava@hotmail.com');
INSERT INTO CUST(CID, CNAME, ADDRESS, CITY, DOB ,PHONE, EMAIL) VALUES('C0009', 'YOGESH KUMAR VERMA', 'SECTOR 33', 'GURUGRAM', '09-11-1991', '881784538', 'yogesh@yahoo.com');
INSERT INTO CUST(CID, CNAME, ADDRESS, CITY, DOB ,PHONE, EMAIL) VALUES('C0010', 'GURDEEP SINGH', 'SECTOR 10', 'GURUGRAM', '11-06-1993', '8377836254', 'gurdeep.singh@gmail.com');

-- SELECT * FROM CUST;

INSERT INTO ORDERS (OID, ODATE, PID, CID, OQTY) VALUES ('O0001', '05-24-2023', 'P0001', 'C0004', 4);
INSERT INTO ORDERS (OID, ODATE, PID, CID, OQTY) VALUES ('O0002', '03-12-2023', 'P0002', 'C0001', 3);
INSERT INTO ORDERS (OID, ODATE, PID, CID, OQTY) VALUES ('O0003', '02-01-2023', 'P0004', 'C0002', 5);
INSERT INTO ORDERS (OID, ODATE, PID, CID, OQTY) VALUES ('O0004', '02-03-2023', 'P0008', 'C0007', 6);
INSERT INTO ORDERS (OID, ODATE, PID, CID, OQTY) VALUES ('O0005', '06-21-2023', 'P0012', 'C0010', 12);

-- DROP TABLE ORDERS;
-- SELECT * FROM ORDERS;

SELECT PID, PDESC, CATEGORY, SNAME, SCITY
    FROM PRODUCT
    INNER JOIN SUPPLIER
    ON PRODUCT.SID = SUPPLIER.SID;

SELECT OID, ODATE, CNAME, ADDRESS, PHONE, PDESC, PRICE, OQTY, PRICE * OQTY AS AMOUNT 
    FROM ORDERS
    INNER JOIN PRODUCT
    ON ORDERS.PID = PRODUCT.PID
    INNER JOIN CUST
    ON ORDERS.CID = CUST.CID;


------------------------------------------------------------------------------------------
----------------------------------- ASSIGNMENT 6 -----------------------------------------

CREATE VIEW EMP_SAL_DETAILS  
AS 
    (SELECT EID, NAME, DOJ, DEPT, DESI, BASIC, BASIC * 0.15 AS HRA, BASIC * 0.09 AS PF, (BASIC + BASIC * 0.15 + BASIC * 0.09) AS NET, (BASIC + BASIC * 0.15) AS GROSS
    FROM EMP
    INNER JOIN EMP_SAL
    ON EMP.EID = EMP_SAL.EMPID);

-- SELECT * FROM EMP_SAL_DETAILS;

CREATE VIEW MANAGERS_JOINED_IN_2019 
AS
    (SELECT EID, NAME, DOJ, DESI, DEPT 
    FROM EMP 
    INNER JOIN EMP_SAL
    ON EMP.EID = EMP_SAL.EMPID
    WHERE DESI = 'MGR' AND DOJ > '2019-01-01');

-- SELECT * FROM MANAGERS_JOINED_IN_2019;

-- SELECT * FROM EMP;
-- SELECT * FROM EMP_SAL;

SELECT COUNT(EMP.EID), SUM(BASIC), AVG(BASIC), CITY, DEPT 
FROM EMP
INNER JOIN EMP_SAL 
ON EMP.EID = EMP_SAL.EMPID
GROUP BY DEPT, CITY;

-- SELECT COUNT(IMPORTED_EMP.EID), SUM(SALARY), AVG(SALARY), CITY, DEPT 
-- FROM IMPORTED_EMP
-- INNER JOIN IMPORTED_EMP_SAL 
-- ON IMPORTED_EMP.EID = IMPORTED_EMP_SAL.EID
-- GROUP BY DEPT, CITY;

-- SELECT * FROM IMPORTED_EMP;
-- SELECT * FROM IMPORTED_EMP_SAL;

CREATE VIEW BILL 
AS (
    SELECT OID, ODATE, CNAME, ADDRESS, PHONE, PDESC, PRICE, OQTY, PRICE * OQTY AS AMOUNT
        FROM ORDERS
        INNER JOIN PRODUCT
        ON ORDERS.PID = PRODUCT.PID
        INNER JOIN CUST
        ON ORDERS.CID = CUST.CID
);

-- SELECT * FROM BILL;